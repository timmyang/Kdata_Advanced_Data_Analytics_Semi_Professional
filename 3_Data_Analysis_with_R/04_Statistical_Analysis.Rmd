---
title: "Part 4: Statistical Analysis"
output: rmarkdown::github_document
---

# Table of Contents

- **Chapter 1 - 통계분석의 이해 (Understanding Statistical Analysis)**
  - 통계
  - 통계자료의 획득 방법
  - 통계분석
  - 확률 및 확률분포
  - 추정과 가설검정
  - 비모수 검정
 
- **Chapter 2 - 기초 통계분석 (Introductory Statistical Analysis)**
  - 기술통계(Descriptive Statistics)
  - 인과관계의 이해
  - 상관분석(Correlation Analysis)

- **Chapter 3 - 회귀분석**
  - 회귀분석의 정의
  - 단순선형회귀분석
  - 다중선형회귀분석
  - 회귀분석의 종류
  - 회귀분석 사례
  - 최적회귀방정식


# Chapter 1 - 통계분석의 이해 (Understanding Statistical Analysis)

## 1. 통계

- 특정집단을 대상으로 수행한 조사나 실험을 통해 나온 결과에 대한 요약된 형태의 표현이다
  - <예시> 일기예보, 물가/실업률/GNP, 정당 지지도, 의식조사와 사회조사 분석 통계, 임상실험 등의 실험 결과 분석 통계
- 조사 또는 실험을 통해 데이터를 확보, 조사대상에 따라 총조사(census)와 표본조사로 구분한다

## 2. 통계자료의 획득 방법

#### 가. 총 조사/전수 조사(census)

- 대상 집단 모두를 조사하는데 많은 비용과 시간이 소요되므로 특별한 경우를 제외하고는 사용되지 않는다 (ex. 인구주택 총 조사)

#### 나. 표본조사

- 대부분의 설문조사가 표본조사로 진행되며 모집단에서 샘플을 추출하여 진행하는 조사이다
- **모집단(population):** 조사하고자 하는 **대상 집단 전체**
- **원소(element):** **모집단을 구성** 하는 개체
- **표본(sample):** 조사하기 위해 **추출한 모집단의 일부 원소**
- **모수(parameter):** 표본 관측에 의해 구하고자 하는 **모집단에 대한 정보**
- 모집단의 정의, 표본의 크기, 조사방법, 조사기간, 표본추출방법을 정확히 명시해야 한다

#### 다. 표본 추출 방법

- 표본조사의 중요한 점은 모집단을 대표할 수 있는 표본 추출이므로 표본 추출 방법에 따라 분석결과의 해석은 큰 차이가 발생한다 (N개의 모집단에서 n개의 표본을 추출하는 경우)
- **[1] 단순랜덤 추출법(simple random sampling)**
  - 각 샘플에 번호를 부여하여 임의의 n개를 추출하는 방법으로 각 샘플은 선택될 확률이 동일하다 (비복원, 복원(추출한 element를 다시 집어넣어 추출하는 경우)추출)
- **[2] 계통추출법(systematic sampling)**
  - 단순랜덤추출법의 변형된 방식으로 번호를 부여한 샘플을 나열하여 K개씩 (K = N/n) n 개의 구간으로 나누고 첫 구간(1, 2, ..., K)에서 하나를 임의로 선택한 후에 K개씩 띄어서 n개의 표본을 선택한다
  - 즉, 임의 위치에서 매 k번째 항목을 추출하는 방법이다
- **[3] 집락추출법(cluster random sampling)**
  - 군집을 구분하고 군집별로 단순랜덤 추출법을 수행한 후, 모든 자료를 활용하거나 샘플링하는 방법이다. (지역표본추출, 다단계표본추출)
- **[4] 층화추출법(stratified random sampling)**
  - 이질적인 원소들로 구성된 모집단에서 각 계층을 고루 대표할 수 있도록 표본을 추출하는 방법으로, 유사한 원소끼리 몇 개의 층(stratum)으로 나누어 각 층에서 랜덤 추출하는 방법이다. (비례층화추출법, 불비례층화추출법)
  
#### 라. 측정(measurement)

- **[1] 개요**
  - 표본조사나 실험을 실시하는 과정에서 추출된 원소들이나 실험 단위로부터 주어진 목적에 적합하도록 관측해 자료를 얻는 것이다
  
- **[2] 측정방법**
  - 질적척도 (범주형자료, 숫자들의 크기 차이가 계산되지 않는 척도)
    - **명목척도**
      - 측정 대상이 어느 **집단** 에 소속하는지 분류할 때 사용 (성별, 출생지 구분)
    - **순서척도**
      - 측정 대상의 **서열관계** 를 관측하는 척도 (만족도, 선호도, 학년, 신용등급)
  - 양적척도(수치형자료, 숫자들의 크기 차이를 계산할 수 있는 척도)  
    - **구간척도(등간척도)**
      - 측정 대상이 갖고 있는 **속성의 양** 을 측정하는 것으로 구간이나 구간 사이의 **간격이 의미가 있는** 자료 (온도, 지수)
    - **비율척도**
      - 간격(차이)에 대한 비율이 의미를 가지는 자료
      - **절대적 기준인 0잉 존재** 하고 **사칙연산이 가능** 하며 제일 많은 정보를 가지는 척도 (무게, 나이, 시간, 거리)

**기출문제**  
**75. 표본조사나 실험을 실시하는 과정에서 추출된 원소들이나 실험 단위로부터 주어진 목적에 적합하도록 관측해 자료를 얻는 것을 측정(measurement)라 한다. 다음 중 자료의 종류에 대한 설명으로 가장 부적절한 것은?**

1. 명목척도 - 측정 대상이 어느 집단에 속하는지 분류할 때 사용  
2. 순서척도 - 측정 대상의 특성이 가지는 서열관계를 관측하는 척도  
3. 구간척도 - 축정 대상이 갖는 속성의 양을 측정하는 것으로 구간이나 구간 사이의 간격이 의미가 있는 자료  
4. **비율척도 - 절대적 기준인 원점이 존재하지 않으며 모든 사칙연산이 가능한 척도**


## 3. 통계분석

#### 가. 정의

- 특정한 집단이나 **불확실한 현상** 을 대상으로 자료를 수집해 대상 집단에 대한  정보를 구하고, **적절한 통계분석 방ㅇ법을 이용해 의사결정을 하는 과정** 이다

#### 나. 기술통계(descriptive statistics)

- 주어진 자료로부터 어떠한 판단이나 예측과 같은 주관이 섞일 수 있는 과정을 배제하여 통계집단들의 여러 특성을 수량화하여 객관적인 데이터로 나타내는 통계분석 방법론이다
- Sample에 대한 특성인 평균, 표준편차, 중위수, 최빈값, 그래프, 왜도, 첨도 등을 구하는 것을 의미한다

#### 다. 통계적 추론(추측통계, inference statistics)

- 수집된 자료를 이용해 대상 집단(모집단)에 대한 의사결정을 하는 것으로 Sample을 통해 모집단을 추정하는 것을 의미한다
- **[1] 모수추정**
  - 표본집단으로부터 **모집단의 특성인 모수(평균, 분산 등)를 분석** 하여 모집단을 추론한다
- **[2] 가설검정**
  - 대상집단에 대해 특정한 가설을 설정한 후에 그 가설이 **옳은지 그른지에 대한 채택여부를 결정** 하는 방법론이다
- **[3] 예측**
  - 미래의 **불확실성을 해결해 효율적인 의사결정** 을 하기 위해 활용한다. (에: 회귀분석, 시계열분석 등의 방법이 있다)

## 4. 확률 및 확률분포

#### 가. 확률

- 표본공간 S에 부분집합인 각 사상에 대해 실수값을 가지는 함수의 확률값이 0과 1사이에 있고, 전체 확률의 합이 1인 것을 의미한다
- 표본공간 <img src="https://render.githubusercontent.com/render/math?math=$\Omega$">의 부분집합인 사건 E의 확률은 표본공간의 원소의 개수에 대한 사건 E의 개수의 비율로 확률을 P(E)라고 할때, 다음과 같이 정의한다
- <img src="https://render.githubusercontent.com/render/math?math=$P(E)= n(E)/n(\Omega)$">

- **[1] 표본공간(sample space, <img src="https://render.githubusercontent.com/render/math?math=$\Omega$">)**
  - 어떤 실험을 실시할 때 나타날 수 있는 **모든 결과들의 집합** 이다

- **[2] 사건(event)**
  - 관찰자가 관심이 있는 사건으로 표본공간의 부분집합이다

- **[3] 원소(element)**
  - 나타날 수 있는 개별의 결과들을 의미한다

- **[4] 확률변수(random variable)**
  - 특정값이 나타날 가능성이 확률적으로 주어지는 변수이다
  - **정의역(Domain)이 표본공간, 치역(Range)가 실수값(0 < y < 1)인 함수** 이다
  - 0이 아닌 확률을 갖는 실수값의 형태에 따라 이산형 확률변수(discrete random variable)와 연속형 확률변수(continuous random variable)로 구분된다
  - 확률변수 X의 기대값(expectation, expected value)은 다음과 같이 정의한다
    - <img src="https://render.githubusercontent.com/render/math?math=$E(X) = \Sigma x_i f(x_i)$">: 이산형 변수인 경우
    - <img src="https://render.githubusercontent.com/render/math?math=$E(X) = \int x f(x) dx$">: 연속형 변수인 경우
  - 일반적으로 확률변수 X의 k차 적률(k-th moment)
    - <img src="https://render.githubusercontent.com/render/math?math=$E(X^k) = \Sigma x^k_i f(x_i)$">: 이산형 본수인 경우
    - <img src="https://render.githubusercontent.com/render/math?math=$E(X^k) = \int x^k f(x) dx$">: 연속형 변수인 경우
  - 확률변수 X의 k차 중심적률(k-th cental moment)
    - <img src="https://render.githubusercontent.com/render/math?math=$E{(X - \mu ) ^{k}} = \Sigma{x_i - \mu} ^{k} f(x_i)$">: 이산형 변수인 경우
    - <img src="https://render.githubusercontent.com/render/math?math=$E (X - \mu ) ^{k} = \int (x - \mu) ^{k} f(x) dx$">: 연속형 변수인 경우
  - 특히, 2차 중심적률 <img src="https://render.githubusercontent.com/render/math?math=$E(X - \mu ) ^{2} = \sigma ^{2}$">: 모분산(populatino variance)
    - 기대값의 선형성을 이용하면 ${\sigma}^{2} = E(X- \mu)^{2}$
    - <img src="https://render.githubusercontent.com/render/math?math=$= E(X^2 -2 \mu X + \mu ^{2})$">
    - <img src="https://render.githubusercontent.com/render/math?math=$= E(X^2) - 2 \mu E(X) + \mu ^{2}$">
    - <img src="https://render.githubusercontent.com/render/math?math=$= E(X^2) - \mu ^{2}$">
  - 즉, 모분산 = 2차 적률 - 1차 적률^2로 해석 가능
    - <img src="https://render.githubusercontent.com/render/math?math=$E(aX + b) = aE(X) + b$">
    - <img src="https://render.githubusercontent.com/render/math?math=$Var(aX + b) = a^2 Var(X)$">
  - 덧셈정리(배반이 아닐 때)
    - 사건 A와 사건B가 동시에 일어날 수 있들 때(교집합이 성립할 때), 일어날 확률 P(A 또는 B)는 <img src="https://render.githubusercontent.com/render/math?math=$P(A \cup B)$"> = P(A) + P(B) - <img src="https://render.githubusercontent.com/render/math?math=$P(A \cap B)$"> 로 표현된다
    - 사건 B가 주어졌을 때 사건 A의 조건부 확률은 P(A|B) = <img src="https://render.githubusercontent.com/render/math?math=$P(A \cap B)$"> / P(B) 로 표현된다
  - 덧셈정리(배반사건일 때)
    - 사건 A와 사건 B가 동시에 일어나지 않을 때, 즉 사건 A 또는 사건 B 중 어느 한 쪽만 일어날 확률은 <img src="https://render.githubusercontent.com/render/math?math=$P(A \cup B)$"> = P(A) + P(B) 로 표현된다
  - 곱셈정리
    - 사건 A와 B가 서로 무관계하게 나타날 때, 즉, 독립사건일 때 A와 B가 동시에 나타날 확률은 P(A 또는 B)는 <img src="https://render.githubusercontent.com/render/math?math=$P(A \cap B)=$"> P(A) x P(B) 로 표현되고
    - 사건 B가 주어졌을 때 사건 A의 조건부 확률은 P(A|B) = P(A) 로 표현된다

#### 나. 확률분포

- **[1] 이산형 확률변수**
  - 0이 아닌 확률값을 갖는 확률 변수를 셀 수 있는 경우(확률질량함수)
    - <img src="https://render.githubusercontent.com/render/math?math=$P(X_i) > 0, i = 1, 2, ..., k, \Sigma_{i=1}^{k} P(X_i) = 1$">
  - 이산형 확률변수의 예시: 동전 2개를 던져서 앞/뒷면이 나오는 경우의 수(H: 앞, T: 뒤)
    - 표본공간(<img src="https://render.githubusercontent.com/render/math?math=$\Omega$">) = P(x)
    - HH = 1/4
    - HT = 1/4
    - TH = 1/4
    - TT = 1/4
    - 합계 = 1
  - **가) 베르누이 확률분포(Bernoulli distribution)**
    - 결과가 2개만 나오는 경우 (예시: 동전 던지기, 시험의 합/불합격 등)
    - <img src="https://render.githubusercontent.com/render/math?math=$P(X = x) = p^x * (1 - p)^{1 - x}, (x = 1 \ or \ 0)$">
    - <img src="https://render.githubusercontent.com/render/math?math=$E(x) = p, var(x) = p(1 - p)$">
    - <예시> 메이저리거인 추신수 선수가 안타를 칠 확률은 베르누이 분포를 따른다(안타를 치는 사건을 x = 1이라고 할 때 안타를 치리 확률은 타율로 적용 가능)
  - **나) 이항분포(Binomial distribution)**
    - 베르누이 시행을 n번 반복했을 때 k번 성공할 확률
    - P(X = k) = n**C**k **P**^k (1 -p)^(n - k)
    - n**C**k = n! / (k!(n - k)!)
    - <img src="https://render.githubusercontent.com/render/math?math=$x ~ B(n, p), E(x) = np, var(x) = np(1 - p)$">
    - <예시> 메이저리거인 추신수 선수가 오늘 경기에서 5번 타석에 들어와서 3번 안타를 칠 확률은 이항분포를 따른다(n = 5, k = 3, 안타를 칠 확률 P(x) = 타율로 적용 가능)
    - 성공할 확률 p가 0이나 1에 가깝지 않고 n이 충분히 크면 이항분포는 정규분포에 가까워 진다
    - 성공할 확률 p가 1/2에 가까우면 종모양이 된다
  - **다) 기하분포(Geometric distribution)**
    - 성공확률이 p인 베르누이 시행에서 첫번째 성공이 있기까지 x번 실패할 확률
    - <예시> 메이저리거인 추신수 선수가 오늘 경기에서 5번 타석에 들어와서 3번째 타석에서 안타를 칠 확률은 기하분포를 따른다
  - **라) 다항분포(Multinomial distribution)**
    - 이항분포를 확장한 것으로 세가지 이상의 결과를 가지는 반복 시행에서 발생하는 확률 분포
    - P(x1, x2)
  - **마) 포아송분포(Poisson disbritubtion)**
    - 시간과 공간 내에서 발생하는 사건의 발생횟수에 대한 확률분포(예: 책에 오타가 5 page 당 10개씩 나온다고 할 때, 한 페이지에 오타가 3개 나올 확률)
    - <img src="https://render.githubusercontent.com/render/math?math=$\lambda$"> = 정해진 시간 안에 어떤 사건이 일어날 횟수에 대한 기댓값, y = 사건이 일어난 수
    - <img src="https://render.githubusercontent.com/render/math?math=$p(y) = \lim_{x \to \infty}$"> [n y] <img src="https://render.githubusercontent.com/render/math?math=$p^{y} * (1 - p)^{n - y} = \lambda^{y} / y! * e^{-\lambda}$">
    - <예시> 메이저리거인 추신수 선수가 최근 5경기에서 10개의 홈런을 때렸다고 할 때, 오늘 경기에서 홈런을 못 칠 확률은 포아송분포를 따른다

- **[2] 연속형 확률변수**
  - 가능한 값이 실수의 어느 특정구간 전체에 해당하는 확률변수(확률밀도함수)
  - <img src="https://render.githubusercontent.com/render/math?math=$f(x) >= 0, \int_{-\infty}^{\infty} f(x) dx = 1$">
  - **가) 균일분포(일양분포, Uniform distribution)**
    - 모든 확률변수 X가 균일한 확률을 가지는 확률분포(다트의 확률분포)
    - <img src="https://render.githubusercontent.com/render/math?math=$E(X) = (a + b)/2, Var(X) = (b - a)^2/12$">
  - **나) 정규분포(Normal distribution)**
    - 평균이 <img src="https://render.githubusercontent.com/render/math?math=$\mu$"> 이고, 표준편차가 <img src="https://render.githubusercontent.com/render/math?math=$\sigma$">인 x의 확률밀도함수
    - 표준편차가 클 경우 퍼져보이는 그래프가 나타난다
    - <img src="https://render.githubusercontent.com/render/math?math=$f(x) = 1 / (\sqrt{2\pi} \sigma) * e^{-(x- \mu)^{2} / 2 \sigma ^{2}}, -\infty < x < \infty$">
  - **다) 지수분포(Exponential distribution)**
    - 어떤 사건이 발생할 때까지 경과 시간에 대한 연속확률분포이다
    - <예시> 전자레인지의 수명시간, 콜센터에 전화가 걸려올 때까지의 시간, 은행에 고객이 내방하는데 걸리는 시간, 정류소에서 보스가 올 때까지의 시간
    - <img src="https://render.githubusercontent.com/render/math?math=$f(x) = e^{-x}$"> (지수분포밀도함수 <img src="https://render.githubusercontent.com/render/math?math=$\lambda$"> = 1)
    - <img src="https://render.githubusercontent.com/render/math?math=$f(x) = 1/2 * e^{-2/x}$">
  - **라) t-분포(t-distribution)**
    - 표준정규분포와 같이 평균이 0을 중심으로 좌우가 동일한 분포를 따른다
    - 표본의 크기가 적을때는 표준정규분포를 위에서 눌러 놓은것과 같은 형태를 보이지만 표본이 커져서(30개 이상) 자유도가 증가하면 표준정규분포와 거으이 같은 분포가 된다
    - 데이터가 연속형일 경우 활용한다
    - **두 집단의 평균이 동일** 한지 알고자 할 때 검정통계량으로 활용된다
  - **마) X^2 분포 (Chi-square distribution)**
    - 모평균과 모분산이 알려지지 않은 모집단의 모분산에 대한 가설 검정에 사용되는 분포이다
    - **두 집단 간의 동질성 검정에 활용** 된다. (범주형 자료에 대해 얻어진 관측값과 기대값의 차이를 보는 적합성 검정에 활용)
  - **바) F-분포(F-distribution)**
    - **두 집단간 분산의 동일성 검정** 에 사용되는 검정 통계량의 분포이다
    - 확률변수는 항상 양의 값만을 갖고 X^2 분포와 달리 자유도를 2개 가지고 있으며 자유도가 커질수록 정규분포에 가까워 진다
  
**기출문제**  
**76. 다음 중 이산형 확률분포에 해당하지 않는 것은?**

1. 기하 분포  
2. 이항 분포  
3. **지수 분포**   
4. 초기하 분포

**77. 평균이 0이고 표준편차가 1인 정규분포를 표준정규분포라고 한다. 정규분포를 표준정규분포로 만들기 위해 적용하는 표준식은 무엇인가?**

Z = (X - m)/sigma, m = 평균, sigma = 표준편차

**78. 아래의 통계량이 따르는 분포는 무엇인가? (단, $Xbar$ 는 표본평균, $\mu$는 모평균, S는 표본표준편차, n은 표본크기를 나타낸다)**  
<아래> <img src="https://render.githubusercontent.com/render/math?math=$(\overline{X} - \mu)/(S / \sqrt{n})$">

1. 정규분포  
2. **t분포**  
3. F분포  
4. x^2 분포

**79. t-분포에서 자유도가 증가하게 되면 퓨준정규분포 형태에 근접해진다**

TRUE


## 5. 추정과 가설검정

#### 가. 추정의 개요

- **[1] 확률표본(random sample)**
  - 확률분포는 분포를 결정하는 평균, 분산 등의 모수(parameter)를 가지고 있다
  - 특정한 확률분포로부터 독립적으로 반복해 표본을 추출하는 것이다
  - 각 관찰값들은 서로 독립적이며 동일한 분포를 갖는다

- **[2] 추정**
  - 표본으로부터 미지의 모수를 추측하는 것이다
  - 추정은 점추정(point estimation)과 구간추정(interval estimation)으로 구분된다
  - **가) 점추정(point estimation)**
    - **"모수가 특정한 값일 것"** 이라고 추정하는 것이다
    - 표본의 평균, 중위수, 취빈값 등을 사용한다
    - <참고>
    - **불편성(Unbiasedness)**
      - 모든 가능한 표본에서 얻은 추정량의 **기대값** 은 모집단의 모수와 편의(차이)가 없다
    - **효율성(Efficiency)**
      - 추정량의 분산이 작을수록 좋다
    - **일치성(Consistency)**
      - 표본의 크기가 아주 커지면, 추정량이 모수와 거의 같아진다
    - **충족성(Sufficient)**
      - 추정량은 모수에 대하여 모든 정보를 제공한다
    - **표본평균(Sample mean)**
      - 모집단의 평균(모평균)을 추정하기 위한 추정량. 확률표본의 평균값
      - <img src="https://render.githubusercontent.com/render/math?math=$\overline{X} = 1/n \Sigma_{i = 1}^{n} X_i$">
    - **표본분산(Sample variance)**
      - 모집단의 분산(모분산)을 추정하기 위한 추정량
      - <img src="https://render.githubusercontent.com/render/math?math=$s^2 = 1/(n - 1) \Sigma_{i = 1}^{n} (X_i - \overline{X})^2$">
  - **나) 구간추정(Interval estimation)**
    - 점추정의 정확성을 보완하기 위해 확률로 표현된 믿음의 정도 하에서 **모수가 특정한 구간에 있을 것이라고 선언** 하는 것이다
    - 항상 추정량의 분포에 대한 전제가 주어져야 하고, 구해진 구간 안에 모수가 있을 가능성의 크기(신뢰수준, Confidence Interval)가 주어져야 한다
    - <참고>
    - 95% 신뢰수준 하에서 모평균의 신뢰구간
      - **모분산 <img src="https://render.githubusercontent.com/render/math?math=$\sigma^{2}$">이 알려져 있는 경우**
        - <img src="https://render.githubusercontent.com/render/math?math=$\overline{X} - 1.96 (\sigma / \sqrt{n}), \overline{X}$"> + 1.96 * <img src="https://render.githubusercontent.com/render/math?math=$\sigma / \sqrt{n})$">
        - 표준정규분포 N(0, 1)를 따르는 <img src="https://render.githubusercontent.com/render/math?math=$Z = (\overline{X} - \mu)/(\sigma / \sqrt{n})$"> 통계량 이용
      - **모분산 <img src="https://render.githubusercontent.com/render/math?math=$\sigma^2$">이 알려져 있지 않은 경우** 모분산 대신 표본분산을 사용
        - <img src="https://render.githubusercontent.com/render/math?math=$\overline{X}$"> - 2.26 * S / <img src="https://render.githubusercontent.com/render/math?math=$\sqrt{n}, \overline{X}$"> + 2.26 * S/ <img src="https://render.githubusercontent.com/render/math?math=$\sqrt{n}$">
        - 자유도가 n - 1인 t-분포를 따르는 <img src="https://render.githubusercontent.com/render/math?math=$T = (\overline{X} - \mu) / (S / \sqrt{n})$"> 통계량 이용
    
#### 나. 가설검정

- **[1] 정의**
  - 모집단에 대한 어떤 가설을 설정한 뒤에 표본관찰을 통해 그 가설의 채택여부를 결정하는 분석방법이다
  - 표본 관찰 또는 실험을 통해 귀무가설(null hypothesis, H_0)과 대립가설(H_1) 중에서 하나를 선택하는 과정이다
  - 귀무가설이 옳다는 전제하에 검정통계량 값을 구한 후에 이 값이 나타날 가능성의 크기에 의해 귀무가설의 채택여부를 결정한다
  - **가) 귀무가설(null hypothesis, H_0)**
    - **"비교하는 값과 차이가 없다, 동일하다"** 를 기본개념으로 하는 가설
  - **나) 대립가설(alternative hypothesis, H_1)**
    - **뚜렷한 증거가 있을 때 주장하는 가설**
  - **다) 검정통계량(test statistic)**
    - 관찰된 표본으로부터 구하는 통계량
    - 검정 시 가설의 진위를 판단하는 기준
  - **라) 유의수준(significance level, alpha)**
    - 귀무가설을 기각하게 되는 확률의 크기로 "귀무가설이 옳은데도 이를 기각하는 확률의 크기"
  - **마) 기각역(critical region, C)**
    - 귀무가설이 옳다는 전제 하에서 구한 검정통계량의 분포에서 확률이 유의수준 alpha 인 부분 (반대는 채택역(acceptance region))
  - <참고>
  - **사실: H_0가 사실임**
  - 판정: H_0가 사실
    - 옳은 결정
  - 판정: H_0가 사실이 아님
    - 제1종 오류(alpha)
  - **사실: H_0가 사실이 아님**
  - 판정: H_0가 사실
    - 제2종 오류(beta)
  - 판정: H_0가 가실이 아님
    - 옳은 결정
    
**기출문제**  
**80. 다음 중 모분산의 추론에 대한 설명으로 가장 부적절한 것은?**

1. 모집단의 변동성 또는 퍼짐의 정도에 관심이 있는 경우, 모분산이 추론의 대상이 된다  
2. **정규모집단으로부터 n개를 단순 임의 추출한 표본의 분산은 자유도가 n - 1인 t 분포를 따른다**  
3. 모집단이 정규분포를 따르지 않더라도 중심극한정리를 통해 정규모집단으로부터의 모분산에 대한 검정을 유사하게 시행할 수 있다  
4. 이 표본에 의한 분산비 검정은 두 표본의 분산이 동일한지를 비교하는 검정으로 검정통계량은 F분포를 따른다

(해설): X^2(chi-square) 분포를 따른다

**81. 다음 제 1종 오류에 대한 설명 중 올바른 것은?**

1. H_0가 사실일 때, H_0가 사실이라고 판명  
2. H_0가 사실이 아닐 때, H_0가 사실이라고 판정  
3. **H_0가 사실일 때, H_0가 사실이 아니라고 판정**  
4. H_0가 사실이 아닐 때, H_0가 사실이 아니라고 판정

## 6. 비모수 검정

- 통계적 검정에서 모집단의 모수에 대한 검정은 모수적 검정과 비모수적 검정으로 구분한다

#### 가. 모수적 방법

- 검정하고자 하는 **모집단의 분포에 대한 가정** 을 하고, 그 가정하에서 검정통계량과 검정통계량의 분포를 유도해 검정을 실시하는 방법이다

#### 나. 비모수적 방법

- 자료가 **추출된 모집단의 분포에 대한 아무 제약을 가하지 않고 검정을 실시** 하는 방법이다
- 관측된 자료가 특정분포를 따른다고 가정할 수 없는 경우에 이용한다
- 관측된 **자료의 수가 많지 않거나** (30개 미만) 자료가 개체간의 **서열관계를 나타내는 경우** 에 이용한다

#### 다. 모수적 검정과 비모수 검정의 차이점

- **[1] 가설의 검정**
  - 가) 모수적 검정
    - 가정된 분포의 모수에 대해 가설을 설정한다
  - 나) 비모수 검정
    - **가정된 분포가 없으므로** 가설은 단지 "분포의 형태가 동일하다" 또는 "분포의 형태가 동일하지 않다"와 같이 **분포의 형태에 대해 설정** 한다

- **[2] 검정 방법**
  - 가) 모수적 검정
    - 관측된 자료를 이용해 구한 **표본평균, 표본분산** 등을 이용해 검정을 실시한다
  - 나) 비모수적 검정
    - 관측값의 절대적인 크기에 의존하지 않는 **관측값들의 순위(rank)** 나 **두 관측값 차이의 부호** 등을 이용해 검정한다

#### 라. 비모수 검정의 예

- 부호검정(sign test), 윌콕슨의 순위합검정(rank sum test), 윌콕슨의 부호순위합검정(Wilcoxon signed rank test), 만-위트니의 U 검정, 런검정(run test), 스피어만의 순위상관계수

**82-1. 통계적 추론에서 모집단의 모수를 검증하기 위해 사용하는 모수적 방법과 비교하여 비모수적 방법의 특징으로 가장 부적절한 것은?**

1. 비모수적 검정은 모집단의 분포에 대하여 아무런 제약을 가하지 않는다  
2. 관측된 자료가 특정분포를 따른다고 가정할 수 없는 경우에 이용된다  
3. 분포의 모수에 대한 가설을 설정하지 않고 분포의 형태에 대해 가설을 설정한다  
4. **비모수 검정에서는 관측값의 절대적 크기에 의존하여 평균, 분산 등을 이용해 검정을 실시한다**


# Chapter 2 - 기초 통계분석 (Introductory Statistical Analysis)

## 1. 기술통계(Descriptive Statistics)

#### 가. 기술통계의 정의

- 자료의 특성을 표, 그림, 통계량 등을 사용하여 쉽게 파악할 수 있도록 정리/요약하는 것이다
- 자료를 요약하는 기초적 통계를 의미한다
- 데이터 분석에 앞서 데이터의 대략적인 통계적 수치를 계산해봄으로써 데이터에 대한 대략적인 이해와 앞으로 분석에 대한 통찰력을 얻기에 유리하다
- <예시> N, 최소값, 최대값, 평균, 표준편차, 분산

#### 나. 통계량에 의한 자료 정리

- **[1] 중심위치의 측도**
  - 가) 자료(데이터)
    - <img src="https://render.githubusercontent.com/render/math?math=$X_1, X_2, ..., X_n$">
  - 나) 표본평균(sample mean)
    - <img src="https://render.githubusercontent.com/render/math?math=$\overline{X} = 1/n(X_1 + X_2 + ... + X_n) = \Sigma_{i = 1}^{n} X_i/n$">
  - 다) 중앙값(median)
    - 자료를 크기순으로 나열할 때 중앙에 위치하는 자료값이다
    - n이 홀수인 경우 (n + 1)/2
    - n이 짝수인 경우 n/2 번째 값과 n/2 + 1 번째 값의 평균

- **[2] 산포의 측도**
  - 대표적인 산포도(dispersion)는 분산, 표준편차, 범위 및 사분위수범위
  - 가) 분산
    - <img src="https://render.githubusercontent.com/render/math?math=$S^2 = 1/(n - 1) \Sigma_{i = 1}^{n}(X_i - \overline{X})^{2}$">  
    <img src="https://render.githubusercontent.com/render/math?math=$= 1/(n - 1) \Sigma_{i = 1}^{n} (X_i^{2} - 2X_i \overline{X} + \overline{X}^{2})$">  
    <img src="https://render.githubusercontent.com/render/math?math=$= 1 /(n - 1) ( \Sigma_{i = 1}^{n} X_i^{2} \ -2 \Sigma_{i = 1}^{n} X_i \overline{X} \+ \Sigma_{i = 1}^{n} \overline{X}^{2} )$">  
    <img src="https://render.githubusercontent.com/render/math?math=$= 1 /(n - 1) ( \Sigma_{i = 1}^{n} X_i^{2} \ - 2n \overline{X} \overline{X} + n \overline{X}^{2})$">  
    <img src="https://render.githubusercontent.com/render/math?math=$= 1 /(n - 1) ( \Sigma_{i = 1}^{n} X_i^{2} \ - 2n \overline{X}^{2} \ + n \overline{X}^{2})$">  
    <img src="https://render.githubusercontent.com/render/math?math=$= 1 /(n - 1) (\Sigma_{i = 1}^{n} X_i^{2} - n \overline{X}^{2})$">
  
  - 나) 표준편차
    - <img src="https://render.githubusercontent.com/render/math?math=$S = \sqrt{S^2} = \sqrt{1/(n -1) \Sigma_{i = 1}^{n} (X_i - \overline{X})^{2}}$">
    
  - 다) 사분위범위(interquartile range)
    - IQR = Q3 - Q1
  
  - 라) 사분위수
    - 제 1사분위수(Q1)
      - 25백분위수
    - 제 2사위수(Q2)
      - 50백분위수
    - 제 3사분위수(Q3)
      - 75백분위수
      
  - 마) 백분위수(percentile)
    - (n - 1)p / (100 + 1) 번째 값
  
  - 바) 변동계수(coefficient of variation)
    - V = S / <img src="https://render.githubusercontent.com/render/math?math=$\overline{X}$">
  
  - 사) 평균의 표준오차
    - SE(X) = S/ <img src="https://render.githubusercontent.com/render/math?math=$\sqrt{n}$">
    
- **[3] 분포의 형태에 관한 측도**
  - 가) 왜도(Skewness)
    - 분포의 비대칭정도를 나타내는 측도이다
    - <img src="https://render.githubusercontent.com/render/math?math=$m_3 = E ((X - \mu) / \sigma)^{3} = \mu_3 / \sigma_3$">
    - m3 > 0
      - 오른쪽 긴 꼬리를 갖는 분포
    - m3 = 0
      - 좌우가 대칭인 분포
    - m3
      - 왼쪽으로 긴 꼬리를 갖는 분포
  - 나) 첨도(Kurtosis)
    - 분포의 중심에서 뾰족한 정도를 나타내는 측도이다 
    - <img src="https://render.githubusercontent.com/render/math?math=$m_4 = E ((X - \mu) / \sigma)^{4} - 3 = \mu_4 / \sigma_4 - 3$">
    - m4 > 0
      - 표준정규분포 보다 더 뾰족함
    - m4 = 0
      - 표준정규분포와 유사한 뾰족함
    - m4 < 0
      - 표준정규분포 보다 덜 뾰족함

#### 다. 그래프를 이용한 자료 정리

- **[1] 히스토그램**
  - 표로 되어 있는 도수 분포를 그림으로 나타낸 것으로, 도수분포표를 그래프로 나타낸 것이다
- **[2] 막대그래프와 히스토그램의 비교**
  - 가) 막대그래프
    - **범주(category)형** 으로 구분된 데이터(예: 직업, 종교, 음식 등)를 표현하며 범주의 순서를 위도에 따라 바꿀 수 있다
  - 나) 히스토그램
    - **연속(continuous)형** 으로 표시된 데이터(예: 몸무게, 성적, 연봉 등)를 표현하며 임의로 순서를 바꿀 수 없고 막대의 간격이 없다
- **[3] 히스토그램의 생성**
  - 데이터의 수를 활용해서 계급의 수와 계급간격을 계산하여 도수분포표를 만들고 히스토그램을 생성한다
  - 계급의 수는 <img src="https://render.githubusercontent.com/render/math?math=$2^{k} \geq n$">을 만족하는 최소의 정수 <img src="https://render.githubusercontent.com/render/math?math=$log_2 n = k$">에서 최소의 정수이다 (k는 계급 수, n은 데이터 수)
  - 계급의 간격은 (최댓값 - 최소값)/계급수로 파악할 수 있다
  - 계급의 수와 간격이 변하면 히스토그램의 모양이 변한다

- **[4] 줄기-잎 그림(stem and leaf plot)**
  - 데이터를 줄기와 잎의 모양으로 그린 그림
  
- **[5] 상자그림(Box plot)**
  - 다섯 숫자 요약을 통해 그림으로 표현(최소값, Q1, Q2, Q3, 최대값)
  - 사분위수범위(IQR)
    - Q3 - Q1
  - 안울타리(Inner fence)
    - Q1 - 1.5 x IQR 또는 Q3 + 1.5 x IQR
  - 바깥울타리(Outer fence)
    - Q1 - 3 x IQR 또는 Q3 + 3 x IQR
  - 보통이상점(Mild doutlier)
    - 안쪽 울타리와 바깥 울타리 사이(밖)에 있는 자료
  - 극단이상점(Extreme outlier)
    - 바깥울타리 밖의 자료
  
**기출문제**  
**83. 아래의 데이터는 두 가지 종류의 수면유도제(group)에 대한 랜덤으로 선정된 두 그룹의 환자들을 대상으로 수면시간의 증감(extra)을 측정한 자료이다. 다음의 결과에 대한 설명 중 부적절한 것은?**

1. **수면유도제 2에 의한 수면증가량의 분포는 왼쪽으로 꼬리가 긴 형태이다**  
2. 수면유도제 1은 적어도 25%의 환자의 수면시간을 오히려 감소시켰다  
3. 이상치는 두 그룹 모두에서 존재하지 않는다  
4. 수면유도제 2가 수면유도제 1보다 효과적인 것으로 추정할 수 있으나 그 통계적 유의성은 판단 할 수 없다

**84. 아래 그림에서 (a), (b), (c)에 해당하는 통계량으로 적절한 것은?**

2. **(a) 최빈값, (b) 중앙값, (c) 평균**

**85. 첨도에 대한 설명으로 틀린 것은?**

1. 첨도 값이 0보다 크면 표준정규분포 보다 더 뾰족하다  
2. 첨도 값이 0보다 작으면 표준정규분포 보다 덜 뾰족하다  
3. **첨도 값이 0이면 표준정규분포 보다 더 뾰족하다**  
4. 첨도는 분포의 중심에서 뾰족한 정도를 나타내는 측도이다


## 2. 인과관계의 이해

#### 가. 용어

- **[1] 종속변수(반응변수, y)**
  - 다른 변수의 영향을 받는 변수

- **[2] 독립변수(설명변수, x)**
  - 영향을 주는 변수

- **[3] 산점도(scatter plot)**
  - 좌표평면 위에 점들로 표현한 그래프
  
#### 나. 공분산(covariance)

- 두 확률변수 X, Y의 방향의 조합(선형성)이다
  - <img src="https://render.githubusercontent.com/render/math?math=$Cov(X, Y) = E(X - \mu_X)(Y - \mu_Y)$">
- 공분산의 부호만으로 두 변수간의 방향성을 확인할 수 있다
- 공분산의 부호가 + 이면 두 변수는 양의 방향성, - 이면 음의 방향성을 가진다
- X, Y가 서로 독립이면, Cov(X, Y) = 0 이다
  - <img src="https://render.githubusercontent.com/render/math?math=$Cov(X, Y) = \sigma_{XY} = E(XY) - E(X)E(Y)$">

## 3. 상관분석(Correlation Analysis)

#### 가. 상관분석의 정의

- 두 변수 간의 관계의 정도를 알아보기 위한 분석방법이다
- 두 변수의 상관관계를 알아보기 위해 상관계수(Correlation coefficient)를 이용하며, 그 공식은 아래와 같다
  - <img src="https://render.githubusercontent.com/render/math?math=$r = cov(x, y)/(S_x * S_y)$">   
  <img src="https://render.githubusercontent.com/render/math?math=$\Sigma_{i = 1}^{n}((x - \overline{x})(y - \overline{y}))/n(S_x *S_y)$">

#### 나. 상관관계의 특성

- **0.7 < r <= 1**
  - 강한 양(+)의 상관이 있다
- **0.3 < r <= 0.7**
  - 약한 양(+)의 상관이 있다
- **0 < r <= 0.3**
  - 거의 상관이 없다
- **r = 0**
  - 상관관계(선형, 직선)가 존재하지 않는다
- **-0.3 <= r < 0**
  - 거의 상관이 없다
- **-0.7 <= r < -0.3**
  - 약한 음(-)의 상관이 있다
- **-1 <= r < -0.7**
  - 강한 음(-)의 상관이 있다

#### 다. 상관분석의 유형

- **개념**
  - **피어슨**
    - 등간척도 이상으로 측정된 두 변수들의 상관 관계 측정 방식
  - **스피어만**
    - 서열척도인 두 변수들의 상관관계 측정 방식

- **특징**
  - **피어슨**
    - 연속형 변수, 정규성 가정
    - 대부분 많이 사용
  - **스피어만**
    - 순서형 변수, 비모수적 방법
    - 순위를 기준으로 상관관계 측정
  
- **상관계수**
  - **피어슨**
    - 피어슨 (r, 적률상관계수)
  - **스피어만**
    - 순위상관계수(p, 로우)
    
#### 라. 상관분석을 위한 R 코드

- **분산**
  - var(x, y = NULL, na.rm = FALSE)
- **공분산**
  - cov(x, y = NULL, use = "everything", method = c("pearson", "kendall", "spearman))
- **상관관계**
  - cor(x, y = NULL, use = "everything", method = c("pearson", "kendall", "spearman"))
  - Hmisc 패키지의 rcorr 사용
    - rcorr(matrix(data_name), type = c("pearson", "kendall", "spearman"))
    
#### 마. 상관분석의 가설 검정

- 상관계수 r이 0이면 입력변수 x와 출력변수 y 사이에는 아무런 관계가 없다
  - 귀무가설(H0): r = 0
  - 대립가설(H1): r != 0
- t 검정통계량을 통해 얻은 p-value 값이 0.05 이하인 경우, 대립가설을 채택하게 되어 우리가 데이터를 통해 구한 상관계수를 활용할 수 있게 된다

#### 바. 상관분석 예제

- datasets 패키지의 "mtcars" 라는 데이터셋의 mpg, hp의 상관관계 분석을 실시한다

```{r}
data(mtcars) # loads the dataset
str(mtcars)

a <- mtcars$mpg
b <- mtcars$hp
```

```{r}
cor(a, b)
cov(a, b)
cor.test(a, b, method = "pearson")
```
- mtcars 데이터셋의 mpg와 hp를 각각 a, b에 저장하여 mpg와 hp의 상관계수, 공분산을 구한 결과, 상관계수는 -0.7761684, 공분산은 -320.7321로 나타났다
- 따라서, mpg와 hp는 상관계수로 강한 음의 상관관계가 있음을 알 수 있고, 공분산으로 음의 방향성을 가짐을 알 수 있다
- cor.test를 이용해 mpg와 hp의 상관관계 분석을 실행한 결과, p-value가 1.788e-07로 유의 수준 0.05보다 작게 나타나므로 mpg와 hp가 상관관계가 있다고 할 수 있다

**기출문제**  
**87. 다음 중 피어슨(r) 상관계수에 대한 설명으로 부적절한 것을 고르시오**

1. 질적척도의 경우 피어슨 상관관계는 나타내지 못한다  
2. **두 변수를 순위로 변환하여 피어슨 상관계수로 정의한다**  
3. -1과 1 사이의 값을 가진다  
4. 0은 상관관계가 없음을 의미한다  

# Chapter 3 - 회귀분석

## 1. 회귀분석의 정의

#### 가. 회귀분석의 정의

- 하나 또는 그 이상의 독립변수들이 종속변수에 미치는 영향을 추정할 수 있는 통계기법이다
- 변수들 사이의 인과관계를 밝히고 모형을 적합하여 관심있는 변수를 예측하거나 추론하기 위한 분석방법이다
- 독립변수의 개수가 하나이면 단순선형회귀분석, 독립변수의 개수가 두 개 이상이면 다중선형 회귀분석으로 분석할 수 있다

#### 나. 회귀분석의 변수

- 영향을 받는 변수(y)
  - 반응변수(response variable)
  - 종속변수(dependent variable)
  - 결과변수(outcome variable)

- 영향을 주는 변수(x)
  - 설명변수(explanatory variable)
  - 독립변수(independent variable)
  - 예측변수(predictor variable)
  
#### 다. 선형회귀분석의 가정

- **[선형성] linearity**
  - 입력변수와 출력변수의 관계가 선형이다 (선형회귀분석에서 가장 중요한 가정)
- **[등분산성] homoscedasticity**
  - 오차의 분산이 입력변수와 무관하게 일정하다
  - 잔차플롯(산점도, scatter plot)을 활용하여 잔차(residual)와 입력변수간에 아무런 관련성이 없게 무작위적으로 고루 분포되어야 등분산성 가정을 만족하게 된다
- **[독립성] independence**
  - 입력변수와 오차는 관련이 없다
  - 자기상관(독립성)을 알아보기 위해 Durbin-Waston 통계량을 사용하며 주로 시계열 데이터에서 많이 활용한다
- **[비상관성] no auto-correlation**
  - 오차들끼리 상관이 없다
- **[정상성(정규성)] normality**
  - 오차의 분포가 정규분포를 따른다
  - Q-Q plot, Kolmogolov-Smirnov 검정, Shapiro-Wilk 검정 등을 활용하여 정규성을 확인한다
  
#### 라. 그래프를 활용한 선형회귀분석의 가정 검토

- **선형성**
  - 설명변수(x)와 반응변수(y)가 선형적 관계에 있음이 전제되어야 한다
- **등분산성**
  - 가) 등분산성을 만족하는 경우
    - 설명변수(x)에 대한 잔차(residuals)의 산점도(scatter plot)를 그렸을 때, x값에 관계없이 잔차(residuals)들의 변동성(분산)이 일정한 형태를 보이면 선형회귀분석의 가정 중 등분산성을 만족한다고 볼 수 있다
  - 나) 등분산성을 만족하지 못하는 경우
    - (a): 설명변수(x)가 커질수록 잔차의 분산이 줄어드는 이분산의 형태
    - (b): 2차항 설명변수가 필요
    - (c): 새로운 설명변수가 필요
- **정규성**
  - Q-Q plot을 출력했을 때, 잔차(residuals)가 대각방향의 직선의 형태를 지니고 있으면 잔차는 정규분포를 따른다고 할 수 있다
  
#### 마. 가정에 대한 검증

- **[1] 단순선형회귀분석**
  - 입력변수와 출력변수간의 선형성을 점검하기 위해 산점도(scatter plot)를 확인한다
- **[2] 다중선형회귀분석**
  - 선형회귀분석의 가정인 선형성, 등분산성, 독립성, 정상성이 모두 만족하는지 확인해야 한다

## 2. 단순선형회귀분석

- 하나의 독립변수가 종속변수에 미치는 영향을 추정할 수 있는 통계기법이다   
<img src="https://render.githubusercontent.com/render/math?math=$y_i = \beta_0 + \beta_1 x_i + \epsilon_i, i = 1, 2, ..., n \ \ \epsilon_i \sim N(0, \sigma^{2})$">
- yi = i번째 종속변수 값
- xi = i번째 독립변수 값
- B0 = 선형 회귀식의 절편
- B1 = 선형 회귀식의 기울기
- Ei = 오차항, 독립적이며 N(0, sigma^2)의 분포를 이룬다

#### 가. 회귀분석에서의 검토사항

- **[1] 회귀계수들이 유의미한가?**
  - 해당 계수의 t 통계량의 p 값이 0.05보다 작으면 해당 회귀계수가 통계적으로 유의하다고 볼 수 있다
- **[2] 모형이 얼마나 설명력을 갖는가?**
  - 결정계수(R^2)를 확인한다. 결정계수는 0 ~ 1 값을 가지며, 높은 값을 가질수록 추정된 회귀식의 설명력이 높다
- **[3] 모형이 데이터를 잘 적합하고 있는가?**
  - 잔차(residuals)를 그래프로 그리고 회귀진단을 한다
  
#### 나. 회귀계수의 추정(최소제곱법, 최소자승법)

- 측정값을 기초로 하여 적당한 제곱합을 만들고 그것을 최소로 하는 값을 구하여 측정결과를 처리하는 방법으로 잔차(residuals)제곱이 가장 작은 선을 구하는 것을 의미하다  

<img src="https://render.githubusercontent.com/render/math?math=$y_i = \beta_0 + \beta_1 x_i + \epsilon_i, \ i = 1, 2, ..., n, \ \epsilon \sim N(0, \sigma^{2})$">  
<img src="https://render.githubusercontent.com/render/math?math=$\Sigma_{i = 1}^{n} (e_i)^{2} = \Sigma_{i = 1}^{n} (y - (\beta_0 + \beta_1X_i))^{2}$">

#### 다. 회귀분석의 검정

- **[1] 회귀계수의 검정**
  - 회귀계수 B1이 0이면 입력변수 x와 출력변수 y 사이에는 아무런 인과관계가 없다
  - 회귀계수 B1이 0이면 적합된 추정식은 아무 의미가 없게 된다
  
```{r}
x <- c(19, 23, 26, 29, 30, 38, 39, 46, 49)
y <- c(33, 51, 40, 49, 50, 69, 70, 64, 89)

lm(y ~ x)
summary(lm(y ~ x))
```

- x의 회귀계순인 t 통계량에 대한 p 값이 0.000581로 나타나, 유의수준인 0.05보다 작으므로 회귀계수의 추정치들이 통계적으로 유의하다
- 결정계수(R^2)는 0.8341으로 높게 나타나 이 회귀식이 데이터를 적절하게 설명하고 있다고는 할 수 있다
- 결정계수(R^2)가 높아 데이터의 설명력이 높고 회귀분석결과에서 회귀식과 회귀계수들이 통계적으로 유의하므로 에어컨 판매대수를 에어컨 예약대수로 추정할 수 있다
- 회귀분석 결과 "판매대수 = 6.4095 + 1.5295 x 예약대수"의 회귀식을 구할 수 있다

- **[2] 결정계수**
  - 전체제곱합(SST, Total Sum of Squares)
    - <img src="https://render.githubusercontent.com/render/math?math=$\Sigma_{i = 1}^{n} (y_i - \overline{y})^{2}$">
  - 회귀제곱합(SSR, Sum of Squared Residuals)
    - <img src="https://render.githubusercontent.com/render/math?math=$\Sigma_{i = 1}^{n} (\hat{y}_i - \overline{y})^{2}$">
  - 오차제곱합(SSE, Sum of Squared Errors)
    - <img src="https://render.githubusercontent.com/render/math?math=$\Sigma_{i = 1}^{n} (y_i - \hat{y})^{2}$">
  - 결정계수(R^2)는 SST에서 SSR의 비율 (SST/SSR), 0 <= R^2 <= 1 (여기서 SST = SSR + SSE)
  - 결정계수(R^2)는 전체 데이터를 회귀모형이 설명할 수 있는 설명력을 의미한다 (단순회귀분석에서 결정계수는 상관계수 r의 제곱과 같다)
  
- **[3] 회귀직선의 적합도 검토**
  - 결정계수(R^2)를 통해 추정된 회귀식이 얼마나 타당한지 검토한다 (결정계수가 1에 가까울수록 회귀모형이 자료를 잘 설명함)
  - 독립변수가 종속변수 변동의 몇 %를 설명하는지 나타내는 지표이다
  - 다변량 회귀분석에서는 독립변수의 수가 많아지면 결정계수가 높아지므로 독립변수가 유의하든, 유의하지 않든 독립변수의 수가 많아지면 결정계수가 높아지는 단점이 있다
  - 이러한 결정계수의 단점을 보완하기 위해 수정된 결정계수(adjusted R^2)를 활용한다
  - 수정된 결정계수는 결정계수보다 작은 값으로 산출되는 특징이 있다
  - 수정된 결정계수  
  <img src="https://render.githubusercontent.com/render/math?math=$R_a^{2} = 1 - ((n-1)(1-R^{2}))/(n-k-1)$">
  
<참조>
오차(error)와 잔차(residual)의 차이

- **오차(Error)**
  - 모집단에서 실제값이 회귀선과 비교해 볼 때 나타나는 차이 (정확치와 관측치의 차이)
- **잔차(Residual)**
  - 표본에서 나온 관측값이 회귀선과 비교해볼 때 나타나는 차이
  

## 3. 다중선형회귀분석

#### 가. 다중선형회귀분석(다변량회귀분석)

- **[1] 다중회귀식**
  - <img src="https://render.githubusercontent.com/render/math?math=$Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + ... + \beta_k X_k + \epsilon$">

- **[2] 모형의 통계적 유의성(significance)**
  - 모형의 통계적 유의성은 F 통계량으로 확인하다
  - 유의수준 5% 하에서 F 통계량의 p 값이 0.05 보다 작으면 추정된 회귀식은 통계적으로 유의하다고 볼 수 있다
  - F = MSR/MSE
  - F 통계량이 크면 p 값이 0.05 보다 작앙지고, 이렇게 되면 귀무가설을 기각한다. 즉, 모형이 유의하다고 결론지을 수 있다

- **[3] 회귀계수의 유의성(significance)**
  - 회귀계수의 유의성은 단변량 회귀분석의 회귀계수 유의성 검토와 같이 t 통계량을 통해 확인한다
  - 모든 회귀계수의 유의성이 통계적으로 검증되어야 선택된 변수들의 조합으로 모형을 활용할 수 있다

- **[4] 모형의 설명력**
  - 결정계수(R^2)나 수정된 결정계수(Ra^2)를 확인한다
  
- **[5] 모형의 적합성**
  - 모형이 데이터를 잘 적합하고 있는지 잔차(residual)와 종속변수(y)의 산점도(scatter plot)를 확인한다

- **[6] 데이터가 전제하는 가정을 만족시키는가?**
  - 선형성, 독립성, 등분산성, 비상관성, 정상성
  
- **[7] 다중공선성(multicollinearity)**
  - 다중회귀분석에서 설명변수들 사이에 선형관계가 존재하는 회귀계수의 정확한 추정이 곤란하다
  - 다중공선성 검사 방법
    - 가) 분상팽창요인(VIF)
      - 4보다 크면 다중공선성이 존재한다고 볼 수 있고, 10 보다 크면 심각한 문제가 있는 것으로 해석할 수 있다
    - 나) 상태지수
      - 10 이상이면 문제가 있다고 보고, 30 보다 크면 심각한 문제가 있다고 해석할 수 있다
        - 다중선형회귀분석에서 다중공선성의 문제가 발생하면, 문제가 있는 변수를 제거하거나 주성분회귀, 능형회귀 모형을 적용하여 문제를 해결한다
    

## 4. 회귀분석의 종류

- **단순회기**
  - 독립변수가 1개이며 종속변수왕의 관계가 직선
- **다중회귀**
  - 독립변수가 k개이며 종속변수와의 관계가 선형(1차 함수)
- **로지스틱 회귀**
  - 종속변수가 범주형(2진 변수)인 경우에 적용되며, 단순 로지스틱 회귀 및 다중, 다항 로지스틱 회귀로 확장할 수 있음
- **다항회귀**
  - 독립변수와 종속변수와의 관계가 1차 함수 이상이 단계(단 k = 1이면 2차 함수 이상)
- **곡선회귀**
  - 독립변수가 1개이며 종속변수와의 관계가 곡선
- **비선형회귀**
  - 회귀식의 모양이 미지의 모수들의 선형관계로 이뤄져 있지 않은 모형
  

## 5. 회귀분석 사례

#### 가. R 프로그램을 통한 회귀분석

- **분석내용**
  - MASS 패키지의 Cars93 라는 데이터셋의 Price를 종속변수로 선정하고 EngineSize, RPM, Weight를 이용해서 다중회귀분석을 실시한다
  
```{r}
# install.packages("MASS")
library(MASS)

data(Cars93)
head(Cars93)

model <- lm(Price ~ EngineSize + RPM + Weight, data = Cars93)
summary(model)
```
- **결과 및 해석**
  - 여기서 F 통계량은 37.89 이며 유의확률 p 값이 6.746e-16 로 유의수준 5% 하에서 추정된 회귀 모형이 통계적으로 매우 유의함(significant)을 알 수 있다
  - 결정계쑤와 수정된 결정계수는 각각 0.5614, 0.5467로 조금 낮게 나타나 이 회귀식이 데이터를 적절하게 설명하고 있다고는 할 수 없다
  - 회귀계수들의 p 값들이 0.05 보다 작으무로 회귀계수의 추정치들이 통계적으로 유의하다
  - 결정계수가 낮아 데이터의 설명력은 낮지만 회귀분석 결과에 회귀식과 회귀계수들이 통계적으로 유의하여 자동차의 가격을 엔진 크기와 RPM 그리고 무게로 추정할 수 있다

## 6. 최적회귀방정식